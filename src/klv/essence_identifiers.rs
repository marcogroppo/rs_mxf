
#[derive(Debug, Clone, PartialEq)]
pub enum EssenceIdentifier {
  BwfFrameWrapped,
  BwfClipWrapped,
  AesFrameWrapped,
  AesClipWrapped,
  MpegEsWithStreamIdFrameWrapped,
  MpegEsWithStreamIdClipWrapped,
  MpegEsWithStreamIdStripeWrapped,
  MpegEsWithStreamIdFixedAudioSizeWrapped,
  MpegEsWithStreamIdSpliceWrapped,
  MpegEsWithStreamIdClosedGopWrapped,
  MpegEsWithStreamIdSlaveWrapped,
  MpegEsWithStreamIdNoSpecificWrappingConstraints,
  GenericEssenceContainerMultipleWrappings,
  Unknown
}

pub fn parse_essence_ul(ul: Vec<u8>) -> EssenceIdentifier {
  match (ul[0], ul[1], ul[2], ul[3], ul[4], ul[5], ul[6], ul[7], ul[8], ul[9], ul[10], ul[11], ul[12], ul[13], ul[14], ul[15]) {
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x01, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x06, 0x01, 0x00) => {
      EssenceIdentifier::BwfFrameWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x01, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x06, 0x02, 0x00) => {
      EssenceIdentifier::BwfClipWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x01, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x06, 0x03, 0x00) => {
      EssenceIdentifier::AesFrameWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x01, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x06, 0x04, 0x00) => {
      EssenceIdentifier::AesClipWrapped
    },

    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x02, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x04,    _,  0x01) => {
      EssenceIdentifier::MpegEsWithStreamIdFrameWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x02, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x04,    _,  0x02) => {
      EssenceIdentifier::MpegEsWithStreamIdClipWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x02, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x04,    _,  0x03) => {
      EssenceIdentifier::MpegEsWithStreamIdStripeWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x02, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x04,    _,  0x05) => {
      EssenceIdentifier::MpegEsWithStreamIdFixedAudioSizeWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x02, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x04,    _,  0x06) => {
      EssenceIdentifier::MpegEsWithStreamIdSpliceWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x02, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x04,    _,  0x07) => {
      EssenceIdentifier::MpegEsWithStreamIdClosedGopWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x02, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x04,    _,  0x08) => {
      EssenceIdentifier::MpegEsWithStreamIdSlaveWrapped
    },
    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x02, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x04,    _,  0x7F) => {
      EssenceIdentifier::MpegEsWithStreamIdNoSpecificWrappingConstraints
    },

    (0x06, 0x0e, 0x2b, 0x34, 0x04, 0x01, 0x01, 0x03, 0x0d, 0x01, 0x03, 0x01, 0x02, 0x7F, 0x01,  0x00) => {
      EssenceIdentifier::GenericEssenceContainerMultipleWrappings
    },
    _ => {
      EssenceIdentifier::Unknown
    }
  }
}
